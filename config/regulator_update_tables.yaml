profile_switch:
  - name: integrity_fail
    integrity_state: Fail
    set_profile: M3_FORENSIC
    deescalation_lock: true
    reason_codes:
      - ReIntegrityFail
  - name: replay_mismatch_degraded
    replay_mismatch: High
    integrity_state: Degraded
    set_profile: M2_QUARANTINE
    deescalation_lock: true
    reason_codes:
      - RcReReplayMismatch
      - ReIntegrityDegraded
  - name: replay_mismatch_high
    replay_mismatch: High
    set_profile: M1_RESTRICTED
    deescalation_lock: true
    reason_codes:
      - RcReReplayMismatch
  - name: receipt_failure_high
    receipt_failures: High
    set_profile: M1_RESTRICTED
    deescalation_lock: true
    reason_codes:
      - RcGeExecDispatchBlocked
  - name: missing_frame
    missing_frame: true
    set_profile: M1_RESTRICTED
    deescalation_lock: true
    reason_codes:
      - ReIntegrityDegraded
  - name: default
    any: true
    set_profile: M0_RESEARCH
    deescalation_lock: false
    reason_codes: []
overlay_enable:
  - name: integrity_fail_overlays
    integrity_state: Fail
    overlays:
      simulate_first: true
      export_lock: true
      novelty_lock: true
      chain_tightening: true
  - name: replay_mismatch_overlays
    replay_mismatch: High
    overlays:
      simulate_first: true
      export_lock: true
      novelty_lock: true
      chain_tightening: true
  - name: receipt_failures_overlay
    receipt_failures: Med
    overlays:
      simulate_first: true
      export_lock: true
      novelty_lock: true
  - name: missing_frame_overlay
    missing_frame: true
    overlays:
      simulate_first: true
      export_lock: true
      novelty_lock: true
      chain_tightening: true
